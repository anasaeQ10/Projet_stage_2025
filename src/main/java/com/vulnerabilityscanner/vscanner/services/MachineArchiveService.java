package com.vulnerabilityscanner.vscanner.services;

import com.vulnerabilityscanner.vscanner.entities.Machine;
import com.vulnerabilityscanner.vscanner.entities.MachineArchive;
import com.vulnerabilityscanner.vscanner.repositories.MachineArchiveRepository;
import org.springframework.stereotype.Service;

import java.time.LocalDateTime;

@Service
public class MachineArchiveService {

    private final MachineArchiveRepository archiveRepository;

    public MachineArchiveService(MachineArchiveRepository archiveRepository) {
        this.archiveRepository = archiveRepository;
    }

    public void archive(Machine machine, String actionType) {
        MachineArchive archive = new MachineArchive();
        archive.setMachineId(machine.getId());
        archive.setName(machine.getName());
        archive.setType(machine.getType());
        archive.setManufacturer(machine.getManufacturer());
        archive.setModel(machine.getModel());
        archive.setSerialNumber(machine.getSerialNumber());
        archive.setIpAddress(machine.getIpAddress());
        archive.setMacAddress(machine.getMacAddress());
        archive.setOperatingSystem(machine.getOperatingSystem());
        archive.setCpu(machine.getCpu());
        archive.setRamGb(machine.getRamGb());
        archive.setStorageGb(machine.getStorageGb());
        archive.setPurchaseDate(machine.getPurchaseDate());
        archive.setWarrantyExpiryDate(machine.getWarrantyExpiryDate());
        archive.setLocation(machine.getLocation());
        archive.setDescription(machine.getDescription());

        archive.setArchivedAt(LocalDateTime.now());
        archive.setActionType(actionType);

        archiveRepository.save(archive);
    }
}
