package com.vulnerabilityscanner.vscanner.services;

import com.vulnerabilityscanner.vscanner.entities.User;
import com.vulnerabilityscanner.vscanner.entities.UserArchive;
import com.vulnerabilityscanner.vscanner.repositories.UserArchiveRepository;
import org.springframework.stereotype.Service;

import java.time.LocalDateTime;

@Service
public class UserArchiveService {

    private final UserArchiveRepository archiveRepository;

    public UserArchiveService(UserArchiveRepository archiveRepository) {
        this.archiveRepository = archiveRepository;
    }

    public void archive(User user, String actionType) {
        UserArchive archive = new UserArchive();
        archive.setUserId(user.getId());
        archive.setMatricule(user.getMatricule());
        archive.setNom(user.getNom());
        archive.setPrenom(user.getPrenom());
        archive.setEmail(user.getEmail());
        archive.setAdresse(user.getAdresse());
        archive.setPays(user.getPays());
        archive.setVille(user.getVille());
        archive.setTelephone(user.getTelephone());
        archive.setDateNaissance(user.getDateNaissance());
        archive.setDateEmbauche(user.getDateEmbauche());
        archive.setRole(user.getRole());
        archive.setArchivedAt(LocalDateTime.now());
        archive.setActionType(actionType);
        archive.setDateCreation(user.getDateCreation());
        archive.setPassword(user.getPassword());

        archiveRepository.save(archive);
    }
}
