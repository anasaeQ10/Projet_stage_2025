package com.vulnerabilityscanner.vscanner.controllers;

import com.vulnerabilityscanner.vscanner.dto.NvdResponse;
import com.vulnerabilityscanner.vscanner.services.NvdService;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.*;

import java.util.List;

@Controller
public class VulnerabilityController {

    private final NvdService nvdService;

    public VulnerabilityController(NvdService nvdService) {
        this.nvdService = nvdService;
    }

    @GetMapping("/search")
    public String showSearchPage() {
        return "search";
    }

    @PostMapping("/search")
    public String handleSearch(@RequestParam String keyword, Model model) {
        List<NvdResponse.CveItem> cveItems = nvdService.searchCveItemsByKeyword(keyword);
        model.addAttribute("keyword", keyword);
        model.addAttribute("cveItems", cveItems);
        return "searchResults";
    }
}
