package com.vulnerabilityscanner.vscanner.dto;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;

import java.util.List;

@JsonIgnoreProperties(ignoreUnknown = true)
public class NvdResponse {

    private List<CveItem> vulnerabilities;

    public List<CveItem> getVulnerabilities() {
        return vulnerabilities;
    }

    public void setVulnerabilities(List<CveItem> vulnerabilities) {
        this.vulnerabilities = vulnerabilities;
    }

    @JsonIgnoreProperties(ignoreUnknown = true)
    public static class CveItem {
        private String id;
        private String sourceIdentifier;
        private String published;
        private String lastModified;
        private String vulnStatus;
        private Cve cve;
        private String englishDescription;
        private CvssData cvss; // Ajout CVSS

        public String getSeverityClass() {
            if (cvss == null) return "";
            switch (cvss.getSeverity()) {
                case "CRITICAL": return "text-red";
                case "HIGH": return "text-orange";
                case "MEDIUM": return "text-yellow";
                case "LOW": return "text-green";
                default: return "";
            }
        }


        public static class CvssData {
            private String version;
            private double baseScore;
            private String severity;
            private String vectorString;

            public String getVersion() {
                return version;
            }

            public void setVersion(String version) {
                this.version = version;
            }

            public double getBaseScore() {
                return baseScore;
            }

            public void setBaseScore(double baseScore) {
                this.baseScore = baseScore;
            }

            public String getSeverity() {
                return severity;
            }

            public void setSeverity(String severity) {
                this.severity = severity;
            }

            public String getVectorString() {
                return vectorString;
            }

            public void setVectorString(String vectorString) {
                this.vectorString = vectorString;
            }
        }

        public String getId() {
            return id;
        }

        public void setId(String id) {
            this.id = id;
        }

        public String getSourceIdentifier() {
            return sourceIdentifier;
        }

        public void setSourceIdentifier(String sourceIdentifier) {
            this.sourceIdentifier = sourceIdentifier;
        }

        public String getPublished() {
            return published;
        }

        public void setPublished(String published) {
            this.published = published;
        }

        public String getLastModified() {
            return lastModified;
        }

        public void setLastModified(String lastModified) {
            this.lastModified = lastModified;
        }

        public String getVulnStatus() {
            return vulnStatus;
        }

        public void setVulnStatus(String vulnStatus) {
            this.vulnStatus = vulnStatus;
        }

        public Cve getCve() {
            return cve;
        }

        public void setCve(Cve cve) {
            this.cve = cve;
        }

        public String getEnglishDescription() {
            return englishDescription;
        }

        public void setEnglishDescription(String englishDescription) {
            this.englishDescription = englishDescription;
        }

        public CvssData getCvss() {
            return cvss;
        }

        public void setCvss(CvssData cvss) {
            this.cvss = cvss;
        }
    }

    @JsonIgnoreProperties(ignoreUnknown = true)
    public static class Cve {
        private String id;
        private List<Description> descriptions;

        public String getId() {
            return id;
        }

        public void setId(String id) {
            this.id = id;
        }

        public List<Description> getDescriptions() {
            return descriptions;
        }

        public void setDescriptions(List<Description> descriptions) {
            this.descriptions = descriptions;
        }
    }

    public static class Description {
        private String lang;
        private String value;

        public String getLang() {
            return lang;
        }

        public void setLang(String lang) {
            this.lang = lang;
        }

        public String getValue() {
            return value;
        }

        public void setValue(String value) {
            this.value = value;
        }
    }
}
